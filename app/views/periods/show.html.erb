<%= page_header @period.name %>
<%= flash_header %>

<div class="grid_4">
	<%= button_to 'Show all people', list_period_url(@period), :method => :get %>
	<%= button_to 'Edit report fields', fields_period_url(@period), :method => :get %>
	<%= button_to 'Edit benchmarks', benchmarks_period_url(@period), :method => :get %>
	<br>
	<h2 width="100%" align="center">Administrators</h2>
	<% if @period.admins.nil? or @period.admins.count == 0 -%>
		<i>None</i>
	<% else -%>
		<ul>
			<% for a in @period.period_admins.sort_by{|a| a.user.sort_name} -%>
				<li>
					<%= link_to_if a.user.can_view?(@cas_user), a.user.display_name, a.user %>
					<% if @period.can_edit_admins?(@cas_user) -%>
						<%= link_to image_tag('icons/silk/delete.png'), a, method: :delete, data: { confirm: 'Are you sure you want to remove this admin?' } %>
					<% end -%>
				</li>
			<% end -%>
		</ul>
	<% end -%>
	<% if @period.can_edit_admins?(@cas_user) -%>
		<%= form_for [@period, @new_admin] do |f| -%>
			<%= render :partial => 'users/new', :locals => {
				:name => 'add_admin',
				:title => 'New Admin',
				:commit => 'Add Admin' } %>
		<% end -%>
	<% end -%>
</div>

<div class="grid_4">
	<h2 width="100%" align="center">Teams</h2>
	<% if @period.teams.nil? or @period.teams.count == 0 -%>
		<i>None</i>
	<% else -%>
		<ul>
			<% for t in @period.teams -%>
				<li>
					<%= link_to t.name, t %>
				</li>
			<% end -%>
		</ul>
	<% end -%>
	<% if @period.can_edit?(@cas_user) -%>
		<%= form_for [@period, @new_team] do |f| -%>
			<%= f.text_field :name, :size => 12 %>
			<%= f.submit %>
		<% end -%>
	<% end -%>
</div>

<div class="grid_4">
	<h2 width="100%" align="center">Coaching Groups</h2>
	<% if @period.groups.nil? or @period.groups.count == 0 -%>
		<i>None</i>
	<% else -%>
		<ul>
			<% for g in @period.groups -%>
				<li>
					<%= link_to g.name, g %>,
					<% if g.coaches.nil? or g.coaches.count == 0 -%>
						Coaches: <i>None</i>
					<% elsif g.coaches.count == 1 -%>
						Coach: <%= g.coaches.first.display_name %>
					<% else -%>
						Coaches: <%= g.coaches.first.display_name -%><% for index in 2..g.coaches.count -%>, <%= g.coaches[index-1].display_name -%><% end -%>
					<% end -%>
				</li>
			<% end -%>
		</ul>
	<% end -%>
	<% if @period.can_edit?(@cas_user) -%>
		<%= form_for [@period, @new_group] do |f| -%>
			<%= f.text_field :name, :size => 12 %>
			<%= f.submit %>
		<% end -%>
	<% end -%>
</div>

<div class="clear"></div>
